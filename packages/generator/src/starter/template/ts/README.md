## Rue Starter Pack

A convenient starter pack for those who don't know anything to get started with rue.  
The files in this directory are automatically generated by the following command.

```bash
$ rue setup all
```

Don't forget to add the following settings to your project's `tsconfig.json` as you are using a decorator.

```diff
{
  "compilerOptions": {
+    "experimentalDecorators": true,
  }
}
```

## What is Rue (Rails on Vue)

`rue` is a micro-framework that allows you to develop using APIs like rails with SPAs made with `Vue` and `React`.  

### Features

`rue` has the following features.

- The `repl` is substantial, and you can see the method definitions like `pry-rails`.
- Usability like `rails/activerecord` and `rails/activemodel`
 - Validations
 - Associations
 - Scope
 - I18n

## Tour of Rue

Let's try `rue`. ðŸš€

`rue console` launches the `node console`.

```bash
$ yarn rue:console
yarn run v1.22.10
$ rue console
[Node] Welcome to Node.js v12.7.0.
[Node] Type ".help" for more information.
[Rue] Loading Rue Modules 50/110.Please override 'this._state'
[Rue] Loading Rue Modules 54/110.
ðŸ› >
```

An error message (`Please override 'this._state'`) is displayed by default, but it is normal.  
Even if an error occurs, loading of other modules will not fail.

Try typing `.help`.

```bash
ðŸ› > .help
.ancs     [Rue] Display ancestors (like Ruby)
.break    Sometimes you get stuck, this gets you out
.clear    Break, and also clear the local context
.desc     [Rue] Display Object.getOwnPropertyDescriptors result
.editor   Enter editor mode
.exit     Exit the repl
.help     Print this help message
.load     Load JS from a file into the REPL session
.loaded   [Rue] Display loaded Classes or RueModules
.lp       [Rue] Display property list
.ls       [Rue] Display method list
.proto    [Rue] Display Object.getPrototypeOf result
.save     Save all evaluated commands in this REPL session to a file
.show     [Rue] Display method definition (format: <Class> or <Class>.<staticMethod> or <Class>.prototype.<instanceMethod>)

Press ^C to abort current expression, ^D to exit the repl
```

A list of actions supported by the repl is displayed.  
The additional definition in rue is that the description starts with `[Rue]`.

```bash
.ancs     [Rue] Display ancestors (like Ruby)
.loaded   [Rue] Display loaded Classes or RueModules
.lp       [Rue] Display property list
.ls       [Rue] Display method list
.proto    [Rue] Display Object.getPrototypeOf result
.show     [Rue] Display method definition (format: <Class> or <Class>.<staticMethod> or <Class>.prototype.<instanceMethod>)
```

Let's try them in order.

### .loaded

Display the class list loaded by repl.

```bash
ðŸ› > .loaded
[Rue] Loading Rue Modules 1/110.Please override 'this._state'
[Rue] Loading Rue Modules 53/110.
[
  'ActiveSupport$Base',
  'ActiveSupport$Registry$Base',
  'ActiveSupport$Info',
  'ActiveModel$Base',
  'ActiveModel$Impl',
  'ActiveModel$Cachable',
  'ActiveModel$Translation',
  'ActiveModel$Validations',
  'ActiveRecord$Impl',
  'ActiveRecord$Base',
  'ActiveRecord$Associations$Holder',
  'ActiveRecord$Relation$Base',
  'ActiveRecord$Relation$Holder',
  'ActiveRecord$Relation$Impl',
  'ActiveRecord$Associations$CollectionProxy$Base',
  'ActiveRecord$Associations$CollectionProxy$Holder',
  'ActiveRecord$Associations$CollectionProxy$Impl',
  'ActiveRecord$Associations$Relation$Base',
  'ActiveRecord$Associations',
  'ActiveRecord$Associations$Impl',
  'ActiveRecord$AttributeMethods',
  'ActiveRecord$Core',
  'ActiveRecord$Dirty',
  'ActiveRecord$Persistence',
  'ActiveRecord$Querying',
  'ActiveRecord$Scoping',
  'ActiveRecord$Scoping$Impl',
  'ActiveRecord$Scoping$Named',
  'ActiveRecord$Associations$Persistence',
  'ActiveRecord$Associations$PersistenceStrategy',
  'ActiveRecord$FinderMethods',
  'ActiveRecord$QueryMethods',
  'ActiveRecord$QueryMethods$Evaluator',
  'Account',
  'Profile',
  'Task',
  'TmpUser',
  'User'
]
```

You can see the definition of the class displayed here.  
For example, it looks like the following.

### .ancs

This is for displaying ancestors like ruby. You can see what you can follow in the `prototype chain` and `the RueModules` that are included and extended. `RueModule` is a module in ruby.

```bash
ðŸ› > .ancs Account
[
  'Account',
  'ActiveRecord',
  'ActiveRecord$Base',
  'ActiveRecord$Impl',
  'ActiveModel$Base',
  'ActiveRecord$Associations (RueModule)',
  'ActiveRecord$Associations$Impl (RueModule)',
  'ActiveRecord$Associations$Persistence (RueModule)',
  'ActiveRecord$Persistence (RueModule)',
  'ActiveRecord$AttributeMethods (RueModule)',
  'ActiveRecord$Dirty (RueModule)',
  'ActiveRecord$Core (RueModule)',
  'ActiveRecord$Scoping (RueModule)',
  'ActiveRecord$Scoping$Impl (RueModule)',
  'ActiveRecord$Scoping$Named (RueModule)',
  'ActiveRecord$Querying (RueModule)',
  'ActiveModel$Impl',
  'ActiveModel$Translation (RueModule)',
  'ActiveModel$Validations (RueModule)',
  'ActiveModel$Cachable (RueModule)',
  'Function',
  'Object'
]
```

### .lp

This is a action for displaying `Object.getOwnPropertyNames` result  


```bash
ðŸ› > .lp Account
[ 'length', 'prototype', 'name', 'fromName' ]

ðŸ› > Object.getOwnPropertyNames(Account)
[ 'length', 'prototype', 'name', 'fromName' ]
```

### .ls

This shows the methods that can be called.  
This is the assumption of the most frequently used action.  
The method is displayed for each `class` and `RueModule` in which the method is implemented.


```bash
ðŸ› > .ls Account
{
  Account: [ 'fromName' ],
  ActiveRecord: [],
  'ActiveRecord$Base': [ 'fetchAll', 'resetRecordCache' ],
  'ActiveRecord$Impl': [],
  'ActiveModel$Base': [],
  'ActiveRecord$Associations (RueModule)': [ 'belongsTo', 'hasOne', 'hasMany' ],
  'ActiveRecord$Associations$Impl (RueModule)': [],
  'ActiveRecord$Associations$Persistence (RueModule)': [],
  'ActiveRecord$Persistence (RueModule)': [
    'createSync',
    'createSyncOrThrow',
    'deleteSync',
    'destroySync',
    'updateSync',
    'create',
    'createOrThrow',
    'delete',
    'destroy',
    'update',
    'RUE_AUTO_INCREMENT_RECORD_ID',
    'RUE_RECORD_ID',
    'RUE_CREATED_AT',
    'RUE_UPDATED_AT',
    'RECORD_ALL'
  ],
  'ActiveRecord$AttributeMethods (RueModule)': [],
  'ActiveRecord$Dirty (RueModule)': [],
  'ActiveRecord$Core (RueModule)': [ 'find' ],
  'ActiveRecord$Scoping (RueModule)': [],
  'ActiveRecord$Scoping$Impl (RueModule)': [],
  'ActiveRecord$Scoping$Named (RueModule)': [ 'all', 'scope' ],
  'ActiveRecord$Querying (RueModule)': [
    'find',                  'findBy',
    'findByOrThrow',         'take',
    'takeOrThrow',           'first',
    'firstOrThrow',          'last',
    'lastOrThrow',           'isExists',
    'isAny',                 'isMany',
    'isNone',                'isOne',
    'findOrCreateBy',        'findOrCreateByOrThrow',
    'findOrInitializeBy',    'createOrFindBy',
    'createOrFindByOrThrow', 'destroyAll',
    'deleteAll',             'updateAll',
    'touchAll',              'destroyBy',
    'deleteBy',              'where',
    'rewhere',               'order',
    'reorder',               'offset',
    'limit',                 'group',
    'unscope'
  ],
  'ActiveModel$Impl': [],
  'ActiveModel$Translation (RueModule)': [
    'translate',
    '$t',
    'humanPropertyName',
    'humanPropName',
    'humanAttributeName'
  ],
  'ActiveModel$Validations (RueModule)': [ 'validates' ],
  'ActiveModel$Cachable (RueModule)': [ 'checkUniqueKey' ],
  Function: [ 'apply', 'bind', 'call', 'toString' ],
  Object: [
    'hasOwnProperty',
    'isPrototypeOf',
    'propertyIsEnumerable',
    'toString',
    'valueOf',
    'toLocaleString'
  ]
}
```

### .proto

This is a action for displaying `Object.getPrototypeOf` result  


```bash
ðŸ› > .proto Account
[Function: ActiveRecord]

ðŸ› > Object.getPrototypeOf(Account)
[Function: ActiveRecord]
```

### .show

This is an action that allows you to see class and method definitions in typescript code.

```bash
ðŸ› > .show Account.prototype.save

From: rue/packages/activerecord/src/records/modules/persistence/core.ts#L380-385
Owner: ActiveRecord$Persistence (RueModule)
Visibility: public
Async: false
Number of lines: 6
Updated At: 2021/04/12 22:23:43 +09:00

  save(opts?: { validate: boolean }): Promise<boolean> {
    // @ts-expect-error
    const _this = this as ActiveRecord$Base;
    // @ts-expect-error
    return Promise.resolve(_this.saveSync(opts));
  }
ðŸ› >
```

This shows that `Account.prototype.save` is defined in RueModule called `ActiveRecord$Persistence`.
The above is a list of actions that can be used with repl.  

Let's look at an example of using `repl`.


```bash
$ rue connsole
[Node] Welcome to Node.js v12.7.0.
[Node] Type ".help" for more information.
[Rue] Loading Rue Modules 50/110.Please override 'this._state'
[Rue] Loading Rue Modules 54/110.
ðŸ› > accounts = await Account.all()
[
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 1,
    id: 1,
    name: 'name_1',
    email: 'name_1@example.com',
    info: { github: 'aaa' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  },
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 2,
    id: 2,
    name: 'name_2',
    email: 'name_2@example.com',
    info: { github: 'bbb' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  },
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 3,
    id: 3,
    name: 'name_3',
    email: 'name_3@example.com',
    info: { github: 'ccc' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  },
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 4,
    id: 4,
    name: 'name_4',
    email: 'name_4@example.com',
    info: { github: 'ddd' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  },
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 5,
    id: 5,
    name: 'name_5',
    email: 'name_5@example.com',
    info: { github: 'eee' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  },
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 6,
    id: 6,
    name: 'name_6',
    email: 'name_6@example.com',
    info: { github: 'fff' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  },
  Account {
    errors: { name: [], email: [] },
    __rue_record_id__: 7,
    id: 7,
    name: 'name_7',
    email: 'name_7@example.com',
    info: { github: 'yukihirop' },
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    tasks: [Function: value],
    profile: [Function: value],
    __rue_created_at__: '2021-04-12T23:58:31+09:00',
    __rue_updated_at__: '2021-04-12T23:58:31+09:00'
  }
]
ðŸ› >
ðŸ› > account = accounts[0]
Account {
  errors: { name: [], email: [] },
  __rue_record_id__: 1,
  id: 1,
  name: 'name_1',
  email: 'name_1@example.com',
  info: { github: 'aaa' },
  _newRecord: false,
  _destroyed: false,
  _associationCache: {},
  tasks: [Function: value],
  profile: [Function: value],
  __rue_created_at__: '2021-04-12T23:58:31+09:00',
  __rue_updated_at__: '2021-04-12T23:58:31+09:00'
}
ðŸ› >
ðŸ› > taskPromise = account.tasks()
Task$ActiveRecord_Associations_CollectionProxy [Promise] {
  {
    holder: ActiveRecord$Associations$CollectionProxy$Holder {
      isHolder: true,
      recordKlass: [Function],
      scope: [],
      _defaultScopeParams: [Object],
      scopeParams: [Object],
      groupedRecords: {},
      errors: [],
      proxy: [],
      flags: [Object],
      associationData: [Object],
      foreignKeyData: [Object]
    },
    scope: Task$ActiveRecord_AssociationRelation [Promise] { <pending> }
  },
  where: [Function],
  rewhere: [Function],
  order: [Function],
  reorder: [Function],
  reverseOrder: [Function],
  offset: [Function],
  limit: [Function],
  group: [Function],
  unscope: [Function],
  find: [Function],
  first: [Function],
  isInclude: [Function],
  last: [Function],
  recordKlass: [Function: Task] { fromStatus: [Function: value] }
}
ðŸ› >
ðŸ› > tasks = await account.tasks()
[
  Task {
    errors: { content: [], status: [] },
    __rue_record_id__: 1,
    id: 1,
    content: 'Create @ruejs of web micro framework',
    status: 'wip',
    accountId: 1,
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    account: [Function: value],
    __rue_created_at__: '2021-04-13T00:00:01+09:00',
    __rue_updated_at__: '2021-04-13T00:00:01+09:00'
  },
  Task {
    errors: { content: [], status: [] },
    __rue_record_id__: 2,
    id: 2,
    content: 'Update r2-oas gem',
    status: 'success',
    accountId: 1,
    _newRecord: false,
    _destroyed: false,
    _associationCache: {},
    account: [Function: value],
    __rue_created_at__: '2021-04-13T00:00:01+09:00',
    __rue_updated_at__: '2021-04-13T00:00:01+09:00'
  }
]
ðŸ› >
ðŸ› > task = tasks[0]
Task {
  errors: { content: [], status: [] },
  __rue_record_id__: 1,
  id: 1,
  content: 'Create @ruejs of web micro framework',
  status: 'wip',
  accountId: 1,
  _newRecord: false,
  _destroyed: false,
  _associationCache: {},
  account: [Function: value],
  __rue_created_at__: '2021-04-13T00:00:01+09:00',
  __rue_updated_at__: '2021-04-13T00:00:01+09:00'
}
ðŸ› > task.$t('status')
'Status'
ðŸ› > task.$t('/status.wip')
'WIP'
ðŸ› >
```
